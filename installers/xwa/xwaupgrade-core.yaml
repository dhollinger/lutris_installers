results:
  - name: "STAR WARS: X-Wing Alliance"
    game_slug: star-wars-x-wing-alliance
    version: "XWAUpgrade - GOG"
    slug: star-wars-x-wing-alliance-xwaupgrade-core
    runner: wine
    gogid: 1421404763
    gogslug: star_wars_xwing_alliance
    script:
      files:
      - install: N/A:Select the installer provided by GOG.
      - xwahacker: https://managedway.dl.sourceforge.net/project/xwahacker/xwahacker-3.2.zip
      - xwaupgrade: https://www.xwaupgrade.com/download/installers/XWAU2020.exe
      - patch: https://www.xwaupgrade.com/download/installers/XWAU2020update_v2.1.exe
      - radiobutton: https://github.com/dhollinger/lutris_installers/raw/master/installers/xwa/RadioButtonBox.exe
      - launcher: https://raw.githubusercontent.com/dhollinger/lutris_installers/master/installers/xwa/xwa.bat
      - cmdow: https://github.com/ritchielawrence/cmdow/archive/v1.4.8.zip
      game:
        arch: win64
        exe: drive_c/GOG Games/Star Wars - X-Wing Alliance/cmdow.exe
        args: /run /hid xwa.bat
        prefix: $GAMEDIR
      installer:
      - task:
          arch: win64
          name: create_prefix
          prefix: $GAMEDIR
      - task:
          arch: win64
          description: Installing .NET 4.6.1
          name: winetricks
          prefix: $GAMEDIR
          app: dotnet461
      - task:
          arch: win64
          description: Installing DirectPlay
          name: winetricks
          prefix: $GAMEDIR
          app: directplay
      - task:
          arch: win64
          description: Running installer. Please quit the installer at the end, do not run the game until this script finishes installing.
          executable: install
          name: wineexec
          prefix: $GAMEDIR
      - task:
          arch: win64
          description: Running patcher.
          executable: patch
          name: wineexec
          prefix: $GAMEDIR
      - extract:
          file: cmdow
          dst: $CACHE/cmdow
      - move:
          dst: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/cmdow.exe
          src: $CACHE/cmdow/bin/Release/cmdow.exe
      - move:
          dst: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/xwa.bat
          src: launcher
      - move:
          dst: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/RadioButtonBox.exe
          src: radiobutton
      - chmodx: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/xwa.bat
      - chmodx: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/RadioButtonBox.exe
      - task:
          arch: win64
          description: Installing XWA Upgrade 2020
          executable: xwaupgrade
          name: wineexec
          prefix: $GAMEDIR
      - task:
          arch: win64
          description: Installing XWA Upgrade 2020 Patch 1
          executable: xwaupatch1
          name: wineexec
          prefix: $GAMEDIR
      - extract:
          description: Prepare XWAHacker
          dst: $CACHE/xwahacker
          file: xwahacker
          format: zip
      - task:
          args: XWINGALLIANCE.EXE -c 0
          executable: $CACHE/xwahacker/xwahacker.exe
          name: wineexec
          prefix: $GAMEDIR
          working_dir: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/
      - task:
          args: XWINGALLIANCE.EXE -c 7
          executable: $CACHE/xwahacker/xwahacker.exe
          name: wineexec
          prefix: $GAMEDIR
          working_dir: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/
      - task:
          description: Set resolution, FoV, and HUD scaling
          args: XWINGALLIANCE.EXE -r 3 1920 1080
          executable: $CACHE/xwahacker/xwahacker.exe
          name: wineexec
          prefix: $GAMEDIR
          working_dir: $GAMEDIR/drive_c/GOG Games/Star Wars - X-Wing Alliance/
      - task:
          arch: win64
          description: setup DXVK manually
          name: winetricks
          prefix: $GAMEDIR
          app: dxvk
      - task:
          key: d3d9
          name: set_regedit
          path: HKEY_CURRENT_USER\Software\Wine\AppDefaults\BabuFriksConfigurator.exe\DllOverrides
          type: REG_SZ
          value: builtin
      - task:
          key: d3d9
          name: set_regedit
          path: HKEY_CURRENT_USER\Software\Wine\AppDefaults\PalpatineTotalConverter.exe\DllOverrides
          type: REG_SZ
          value: builtin
      - task:
          key: d3d9
          name: set_regedit
          path: HKEY_CURRENT_USER\Software\Wine\AppDefaults\XWAU2020update_v1.0.exe\DllOverrides
          type: REG_SZ
          value: builtin
      - task:
          arch: win64
          description: Setting Windows 10 mode
          name: winetricks
          prefix: $GAMEDIR
          app: win10
      wine:
        overrides:
          ddraw.dll: n, b
          dinput.dll: n, b
        dxvk: false
      system:
        env:
          DXVK_STATE_CACHE: '0'
        reset_desktop: true
